<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>肌酐清除率计算器</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: "Microsoft YaHei", "Segoe UI", sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
            padding: 15px;
            background: linear-gradient(135deg, #1e5799, #207cca);
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        h2 {
            font-size: 20px;
            margin: 20px 0 15px;
            color: #1e5799;
            border-bottom: 2px solid #e0e6ed;
            padding-bottom: 8px;
        }
        
        .container {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.08);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-item {
            flex: 1;
            min-width: 200px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #445566;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #d0d7e1;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus {
            border-color: #4a90e2;
            outline: none;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 5px;
        }
        
        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-calculate {
            background: linear-gradient(135deg, #1e5799, #4a90e2);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 14px 25px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: block;
            width: 100%;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .btn-calculate:hover {
            background: linear-gradient(135deg, #15427d, #3b7ac8);
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(0,0,0,0.15);
        }
        
        .btn-calculate:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .results {
            margin-top: 30px;
            padding: 25px;
            background: #f0f7ff;
            border-radius: 8px;
            border-left: 5px solid #4a90e2;
        }
        
        .result-value {
            font-size: 26px;
            font-weight: bold;
            color: #1e5799;
            margin: 15px 0;
            padding: 12px;
            text-align: center;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .detail-item {
            margin-bottom: 10px;
            padding: 12px;
            background: #fff;
            border-radius: 6px;
            font-size: 15px;
            box-shadow: 0 2px 3px rgba(0,0,0,0.03);
        }
        
        .formula-section {
            margin-top: 35px;
            background: #f8f9fc;
            border-radius: 8px;
            padding: 20px;
        }
        
        .formula-box {
            background: white;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-family: "Courier New", monospace;
            font-size: 15px;
            overflow-x: auto;
        }
        
        .note {
            font-size: 14px;
            color: #667788;
            margin-top: 15px;
            padding: 10px;
            background: #fffde7;
            border-radius: 6px;
        }
        
        .explanation {
            margin: 15px 0;
            line-height: 1.7;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            color: #888;
            font-size: 14px;
            padding: 10px;
        }
        
        @media (max-width: 600px) {
            .form-row {
                flex-direction: column;
            }
            
            .input-item {
                min-width: 100%;
            }
            
            h1 {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>肌酐清除率计算器</h1>
        <p>根据患者信息准确计算肌酐清除率 (CrCl)</p>
    </header>
    
    <div class="container">
        <h2>患者信息</h2>
        
        <div class="form-group">
            <label>性别</label>
            <div class="radio-group">
                <div class="radio-item">
                    <input type="radio" id="male" name="gender" value="male" checked>
                    <label for="male" style="font-weight: normal;">男性</label>
                </div>
                <div class="radio-item">
                    <input type="radio" id="female" name="gender" value="female">
                    <label for="female" style="font-weight: normal;">女性</label>
                </div>
            </div>
        </div>
        
        <div class="form-row">
            <div class="input-item">
                <label for="age">年龄 (岁)</label>
                <input type="number" id="age" min="18" max="120" placeholder="输入年龄">
            </div>
            
            <div class="input-item">
                <label for="height">身高 (厘米)</label>
                <input type="number" id="height" min="100" max="250" placeholder="输入身高">
            </div>
        </div>
        
        <div class="form-row">
            <div class="input-item">
                <label for="weight">体重 (kg)</label>
                <input type="number" id="weight" min="30" max="300" placeholder="输入体重">
            </div>
            
            <div class="input-item">
                <label for="creatinine">血清肌酐 (μmol/L)</label>
                <input type="number" id="creatinine" min="10" max="1000" step="0.1" placeholder="输入血清肌酐值">
            </div>
        </div>
        
        <button id="calculateBtn" class="btn-calculate">计算 CrCl</button>
        
        <div class="results">
            <h2>计算结果</h2>
            <div class="result-value" id="resultValue">等待计算...</div>
            
            <div class="detail-item">
                <strong>BMI 值:</strong> <span id="bmiValue">-</span>
                <span id="bmiStatus"></span>
            </div>
            
            <div class="detail-item">
                <strong>理想体重:</strong> <span id="ibwValue">-</span> kg
            </div>
            
            <div class="detail-item">
                <strong>使用的体重类型:</strong> <span id="weightType">-</span>
                (<span id="usedWeight">-</span> kg)
            </div>
            
            <div class="detail-item" id="calculationDetail">
                <strong>详细计算过程:</strong> 
            </div>
        </div>
        
        <div class="formula-section">
            <h2>计算原理与方法</h2>
            
            <div class="explanation">
                <p>计算公式基于以下医学公式，严格遵循您提供的图片中的方法。</p>
            </div>
            
            <h3>核心计算公式</h3>
            <div class="formula-box">
                男性 CrCl (ml/min) = [ (140 - 年龄) × 体重 ] / (72 × 血清肌酐/88.4)<br>
                女性结果 = 男性结果 × 0.85
            </div>
            
            <h3>体重选择标准</h3>
            <div class="formula-box">
                1. BMI &lt; 18.5: 使用实际体重<br>
                2. 18.5 ≤ BMI ≤ 24.9: 使用理想体重<br>
                3. BMI > 24.9: 使用校正体重
            </div>
            
            <h3>其他相关公式</h3>
            <div class="formula-box">
                BMI = 10000 × 体重 (kg) / (身高 × 身高) [身高单位: 厘米]<br>
                男性理想体重 = 50 + 2.3 × [(身高-152.4)/2.54] kg<br>
                女性理想体重 = 45 + 2.3 × [(身高-152.4)/2.54] kg<br>
                校正体重 = 理想体重 + 0.4 × (实际体重 - 理想体重)
            </div>
            
            <div class="note">
                <strong>注意:</strong> 所有计算使用国际标准单位。血清肌酐单位为 μmol/L，身高单位为厘米。
            </div>
        </div>
    </div>
    
    <footer>
        <p>© 2023 肌酐清除率计算器 | 基于临床医学公式</p>
    </footer>

    <script>
        document.getElementById('calculateBtn').addEventListener('click', calculateCrCl);
        
        function calculateCrCl() {
            // 获取输入值
            const gender = document.querySelector('input[name="gender"]:checked').value;
            const age = parseFloat(document.getElementById('age').value);
            const height = parseFloat(document.getElementById('height').value);
            const weight = parseFloat(document.getElementById('weight').value);
            const creatinine = parseFloat(document.getElementById('creatinine').value);
            
            // 验证输入
            if (isNaN(age) || isNaN(height) || isNaN(weight) || isNaN(creatinine)) {
                alert('请填写所有字段，并输入有效的数值');
                return;
            }
            
            // 计算BMI
            const bmi = calculateBMI(weight, height);
            
            // 计算理想体重
            const ibw = calculateIdealWeight(gender, height);
            
            // 根据BMI确定使用的体重类型
            const { usedWeight, weightType } = determineUsedWeight(bmi, weight, ibw);
            
            // 计算CrCl
            let crcl = calculateRawCrCl(age, usedWeight, creatinine);
            
            // 女性调整
            if (gender === 'female') {
                crcl *= 0.85;
            }
            
            // 显示结果
            displayResults(crcl, bmi, ibw, weightType, usedWeight, age, creatinine, gender);
        }
        
        function calculateBMI(weight, height) {
            // BMI = 10000 × 体重 (kg) / (身高 × 身高) [身高单位: 厘米]
            return 10000 * weight / (height * height);
        }
        
        function calculateIdealWeight(gender, height) {
            // 男性理想体重 = 50 + 2.3 × [(身高-152.4)/2.54] kg
            // 女性理想体重 = 45 + 2.3 × [(身高-152.4)/2.54] kg
            const base = (gender === 'male') ? 50 : 45;
            return base + 2.3 * ((height - 152.4) / 2.54);
        }
        
        function determineUsedWeight(bmi, actualWeight, idealWeight) {
            if (bmi < 18.5) {
                return {
                    usedWeight: actualWeight,
                    weightType: '实际体重'
                };
            } else if (bmi <= 24.9) {
                return {
                    usedWeight: idealWeight,
                    weightType: '理想体重'
                };
            } else {
                // 校正体重 = 理想体重 + 0.4 × (实际体重 - 理想体重)
                const adjustedWeight = idealWeight + 0.4 * (actualWeight - idealWeight);
                return {
                    usedWeight: adjustedWeight,
                    weightType: '校正体重'
                };
            }
        }
        
        function calculateRawCrCl(age, weight, creatinine) {
            // 男性 CrCl (ml/min) = [ (140 - 年龄) × 体重 ] / (72 × 血清肌酐/88.4)
            return ((140 - age) * weight) / (72 * creatinine / 88.4);
        }
        
        function displayResults(crcl, bmi, ibw, weightType, usedWeight, age, creatinine, gender) {
            // 显示主要结果
            document.getElementById('resultValue').textContent = 
                `肌酐清除率 (CrCl) = ${crcl.toFixed(2)} ml/min`;
            
            // 显示细节
            document.getElementById('bmiValue').textContent = bmi.toFixed(1);
            
            // BMI状态
            let bmiStatus = '';
            if (bmi < 18.5) {
                bmiStatus = '(低体重)';
            } else if (bmi <= 24.9) {
                bmiStatus = '(正常体重)';
            } else {
                bmiStatus = '(超重/肥胖)';
            }
            document.getElementById('bmiStatus').textContent = bmiStatus;
            
            document.getElementById('ibwValue').textContent = ibw.toFixed(1);
            document.getElementById('weightType').textContent = weightType;
            document.getElementById('usedWeight').textContent = usedWeight.toFixed(1);
            
            // 显示详细计算过程
            const calcDetail = document.getElementById('calculationDetail');
            let detailText = `
                基础公式: (140 - ${age}) × ${usedWeight.toFixed(1)} / (72 × ${creatinine} / 88.4) = ${((140 - age) * usedWeight) / (72 * creatinine / 88.4).toFixed(2)} ml/min`;
            
            if (gender === 'female') {
                detailText += `<br>女性调整: × 0.85 = ${crcl.toFixed(2)} ml/min`;
            }
            
            calcDetail.innerHTML = `<strong>详细计算过程:</strong> ${detailText}`;
        }
        
        // 初始化示例数据（方便测试）
        document.getElementById('age').value = '65';
        document.getElementById('height').value = '170';
        document.getElementById('weight').value = '70';
        document.getElementById('creatinine').value = '90';
    </script>
</body>
</html>